/**
 * Prose Typography
 * 
 * Enhanced typography system for blog reading experience.
 * Includes headings, paragraphs, code, lists, blockquotes, and tables.
 */

/* Typography variables */
:root {
  /* Line heights for optimal readability */
  --line-height-body: 1.7;
  --line-height-heading: 1.3;
  --line-height-code: 1.5;

  /* Letter spacing for technical precision */
  --letter-spacing-tight: -0.02em;
  --letter-spacing-normal: 0;
  --letter-spacing-relaxed: 0.01em;

  /* Vertical rhythm - 8px grid */
  --spacing-1: 0.5rem; /* 8px */
  --spacing-2: 1rem; /* 16px */
  --spacing-3: 1.5rem; /* 24px */
  --spacing-4: 2rem; /* 32px */
  --spacing-6: 3rem; /* 48px */
  --spacing-8: 4rem; /* 64px */

  /* Content width for optimal reading */
  --content-width: 70ch;
}

/* Prose typography enhancements */
.prose {
  /* Body text optimization */
  font-weight: 400;
  letter-spacing: var(--letter-spacing-relaxed);

  /* Headings */
  :where(h1, h2, h3, h4, h5, h6) {
    font-weight: 500;
    letter-spacing: var(--letter-spacing-tight);
    scroll-margin-top: 6rem;
  }

  :where(h1) {
    font-weight: 700;
    line-height: var(--line-height-heading);
  }

  :where(h2) {
    line-height: var(--line-height-heading);
    margin-top: var(--spacing-6);
    margin-bottom: var(--spacing-2);
  }

  :where(h3) {
    line-height: var(--line-height-heading);
    margin-top: var(--spacing-4);
    margin-bottom: var(--spacing-2);
  }

  /* Paragraphs */
  :where(p) {
    line-height: var(--line-height-body);
    margin-top: var(--spacing-3);
    margin-bottom: var(--spacing-3);
  }

  /* First paragraph lead-in */
  :where(p:first-of-type) {
    font-size: 1.125rem;
  }

  /* Strong emphasis */
  :where(strong) {
    font-weight: 700;
  }

  /* Links with smooth transitions */
  :where(a) {
    transition: all 0.2s ease;
    text-decoration-thickness: 1px;
    text-underline-offset: 3px;
  }

  :where(a:hover) {
    filter: brightness(1.2);
  }

  /* Code styling */
  :where(code) {
    font-size: 0.875rem;
    line-height: var(--line-height-code);
    padding: 0.25rem 0.375rem;
    border: 1px solid oklch(from var(--border) l c h / 0.5);
    border-radius: 0.375rem;
    font-weight: 400;
  }

  :where(pre) {
    font-size: 0.875rem;
    line-height: var(--line-height-code);
    padding: 1rem 1.5rem;
    border-radius: 0.5rem;
    margin-top: var(--spacing-4);
    margin-bottom: var(--spacing-4);
  }

  :where(pre code) {
    border: none;
    padding: 0;
    background: transparent;
    font-size: inherit;
  }

  /* Lists */
  :where(ul, ol) {
    margin-top: var(--spacing-3);
    margin-bottom: var(--spacing-3);
  }

  :where(li) {
    margin-top: var(--spacing-1);
    margin-bottom: var(--spacing-1);
    line-height: var(--line-height-body);
  }

  :where(li > ul, li > ol) {
    margin-top: var(--spacing-1);
    margin-bottom: var(--spacing-1);
  }

  /* Blockquotes */
  :where(blockquote) {
    margin-top: var(--spacing-4);
    margin-bottom: var(--spacing-4);
    padding: var(--spacing-3);
  }

  /* Tables */
  :where(table) {
    font-size: 0.875rem;
    line-height: 1.5;
  }

  :where(thead) {
    border-bottom: 2px solid var(--border);
  }

  :where(tbody tr) {
    border-bottom: 1px solid oklch(from var(--border) l c h / 0.5);
  }

  :where(tbody tr:nth-child(even)) {
    background-color: oklch(from var(--muted) l c h / 0.3);
  }
}

/* Dark mode refinements */
.dark .prose {
  /* Reduce eye strain with slightly dimmed text */
  :where(p, li) {
    color: oklch(from var(--foreground) l c h / 0.9);
  }

  /* Enhanced code block contrast */
  :where(pre) {
    background-color: oklch(from var(--card) calc(l - 0.02) c h);
    border-color: oklch(from var(--border) calc(l + 0.05) c h);
  }

  /* Inline code with better visibility */
  :where(code) {
    background-color: oklch(from var(--muted) calc(l + 0.03) c h);
    border-color: oklch(from var(--border) calc(l + 0.03) c h);
  }
}

/* Smooth theme transitions - scoped to elements that actually change */
.prose :where(a, code, pre, blockquote, th, td) {
  transition-property: color, background-color, border-color;
  transition-duration: 0.2s;
  transition-timing-function: ease-in-out;
}

/* Respect reduced motion preferences */
@media (prefers-reduced-motion: reduce) {
  .prose :where(a, code, pre, blockquote, th, td) {
    transition: none;
  }
}
